(self.webpackChunkweave_gitops_docs=self.webpackChunkweave_gitops_docs||[]).push([[9029],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=i,m=p["".concat(s,".").concat(d)]||p[d]||f[d]||a;return n?r.createElement(m,o(o({ref:t},c),{},{components:n})):r.createElement(m,o({ref:t},c))}));function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var u=2;u<a;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},41655:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(67294),i=n(36742),a=n(28084),o={fontSize:16,marginLeft:4,fontVariant:"all-small-caps"};function l(e){var t,n,l,s,u=e.tiers;return r.createElement(i.Z,{to:(l=(0,a.default)()["docusaurus-plugin-content-docs"],s=null==l||null==(t=l.default)||null==(n=t.versions)?void 0:n.find((function(e){return"current"===e.name})),((null==s?void 0:s.path)||"/docs")+"/enterprise/intro"),title:"This feature is a available on "+u,style:o},u)}},36742:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(19756),i=n(67294),a=n(73727),o=n(52263),l=n(13919),s=n(10412),u=(0,i.createContext)({collectLink:function(){}}),c=n(44996),f=n(18780);var p=function(e){var t,n,p=e.isNavLink,d=e.to,m=e.href,h=e.activeClassName,v=e.isActive,b=e["data-noBrokenLinkCheck"],g=e.autoAddBaseUrl,w=void 0===g||g,y=(0,r.Z)(e,["isNavLink","to","href","activeClassName","isActive","data-noBrokenLinkCheck","autoAddBaseUrl"]),k=(0,o.Z)().siteConfig,O=k.trailingSlash,N=k.baseUrl,P=(0,c.C)().withBaseUrl,C=(0,i.useContext)(u),j=d||m,E=(0,l.Z)(j),T=null==j?void 0:j.replace("pathname://",""),x=void 0!==T?(n=T,w&&function(e){return e.startsWith("/")}(n)?P(n):n):void 0;x&&E&&(x=(0,f.applyTrailingSlash)(x,{trailingSlash:O,baseUrl:N}));var _,S=(0,i.useRef)(!1),D=p?a.OL:a.rU,Z=s.Z.canUseIntersectionObserver;(0,i.useEffect)((function(){return!Z&&E&&null!=x&&window.docusaurus.prefetch(x),function(){Z&&_&&_.disconnect()}}),[x,Z,E]);var M=null!==(t=null==x?void 0:x.startsWith("#"))&&void 0!==t&&t,U=!x||!E||M;return x&&E&&!M&&!b&&C.collectLink(x),U?i.createElement("a",Object.assign({href:x},j&&!E&&{target:"_blank",rel:"noopener noreferrer"},y)):i.createElement(D,Object.assign({},y,{onMouseEnter:function(){S.current||null==x||(window.docusaurus.preload(x),S.current=!0)},innerRef:function(e){var t,n;Z&&e&&E&&(t=e,n=function(){null!=x&&window.docusaurus.prefetch(x)},(_=new window.IntersectionObserver((function(e){e.forEach((function(e){t===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(_.unobserve(t),_.disconnect(),n())}))}))).observe(t))},to:x||""},p&&{isActive:v,activeClassName:h}))}},13919:function(e,t,n){"use strict";function r(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!r(e)}n.d(t,{b:function(){return r},Z:function(){return i}})},44996:function(e,t,n){"use strict";n.d(t,{C:function(){return a},Z:function(){return o}});var r=n(52263),i=n(13919);function a(){var e=(0,r.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,a=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,r){var a=void 0===r?{}:r,o=a.forcePrependBaseUrl,l=void 0!==o&&o,s=a.absolute,u=void 0!==s&&s;if(!n)return n;if(n.startsWith("#"))return n;if((0,i.b)(n))return n;if(l)return t+n;var c=n.startsWith(t)?n:t+n.replace(/^\//,"");return u?e+c:c}(a,n,e,t)}}}function o(e,t){return void 0===t&&(t={}),(0,a().withBaseUrl)(e,t)}},28084:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i},useAllPluginInstancesData:function(){return a},usePluginData:function(){return o}});var r=n(52263);function i(){var e=(0,r.Z)().globalData;if(!e)throw new Error("Docusaurus global data not found.");return e}function a(e){var t=i()[e];if(!t)throw new Error('Docusaurus plugin global data not found for "'+e+'" plugin.');return t}function o(e,t){void 0===t&&(t="default");var n=a(e)[t];if(!n)throw new Error('Docusaurus plugin global data not found for "'+e+'" plugin with id "'+t+'".');return n}},8802:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.trailingSlash,r=t.baseUrl;if(e.startsWith("#"))return e;if(void 0===n)return e;var i,a=e.split(/[#?]/)[0],o="/"===a||a===r?a:(i=a,n?function(e){return e.endsWith("/")?e:e+"/"}(i):function(e){return e.endsWith("/")?e.slice(0,-1):e}(i));return e.replace(a,o)}},18780:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.uniq=t.applyTrailingSlash=void 0;var i=n(8802);Object.defineProperty(t,"applyTrailingSlash",{enumerable:!0,get:function(){return r(i).default}});var a=n(29964);Object.defineProperty(t,"uniq",{enumerable:!0,get:function(){return r(a).default}})},29964:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Array.from(new Set(e))}},8806:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return p}});var r=n(22122),i=n(19756),a=(n(67294),n(3905)),o=n(41655),l={title:"Profiles",sidebar_position:6,hide_title:!0},s=void 0,u={unversionedId:"cluster-management/profiles",id:"cluster-management/profiles",isDocsHomePage:!1,title:"Profiles",description:"{frontMatter.title}",source:"@site/docs/cluster-management/profiles.mdx",sourceDirName:"cluster-management",slug:"/cluster-management/profiles",permalink:"/docs/next/cluster-management/profiles",editUrl:"https://github.com/weaveworks/weave-gitops-docs/edit/main/docs/cluster-management/profiles.mdx",version:"current",sidebarPosition:6,frontMatter:{title:"Profiles",sidebar_position:6,hide_title:!0},sidebar:"tutorialSidebar",previous:{title:"Deleting a Cluster",permalink:"/docs/next/cluster-management/deleting-a-cluster"},next:{title:"Introduction",permalink:"/docs/next/enterprise/intro"}},c=[{value:"1. Annotate a Helm chart to make it available for installation",id:"1-annotate-a-helm-chart-to-make-it-available-for-installation",children:[]},{value:"2. Select which profiles you want installed when creating a cluster",id:"2-select-which-profiles-you-want-installed-when-creating-a-cluster",children:[]}],f={toc:c};function p(e){var t=e.components,s=(0,i.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,r.Z)({},f,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",null,l.title," ",(0,a.kt)(o.Z,{tiers:"enterprise",mdxType:"TierLabel"})),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"BEFORE YOU START ")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The following instructions require you to make minor changes to the content of your own hosted Helm repository."))),(0,a.kt)("p",null,"When provisioning new clusters it is often useful to install selected software packages to them as part of their bootstrap process. Weave GitOps Enterprise enables this by installing standard Helm charts to the newly provisioned clusters. This feature lowers the ongoing operational overhead and allows for the clusters to be immediately usable after being provisioned. To set this up you need to:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Annotate a Helm chart to make it available for installation"),(0,a.kt)("li",{parentName:"ol"},"Select which profiles you want installed when creating a cluster")),(0,a.kt)("h3",{id:"1-annotate-a-helm-chart-to-make-it-available-for-installation"},"1. Annotate a Helm chart to make it available for installation"),(0,a.kt)("p",null,"In order for a chart to become available for installation, it needs to include a ",(0,a.kt)("inlineCode",{parentName:"p"},"weave.works/profile")," annotation. For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml",metastring:'title="Chart.yaml"',title:'"Chart.yaml"'},"annotations:\n  weave.works/profile: observability-profile\napiVersion: v1\nappVersion: 1.0.0\ndescription: Observability Helm chart for Kubernetes\nhome: https://github.com/weaveworks/observability-profile\nkubeVersion: '>=1.19.0-0'\nname: observability\nsources:\n- https://github.com/weaveworks/observability-profile\nversion: 1.0.0\n")),(0,a.kt)("p",null,"The annotation value is not important and can be left blank i.e. ",(0,a.kt)("inlineCode",{parentName:"p"},'""'),". Helm charts with the ",(0,a.kt)("inlineCode",{parentName:"p"},"weave.works/profile")," annotation are called ",(0,a.kt)("em",{parentName:"p"},"Profiles"),"."),(0,a.kt)("h3",{id:"2-select-which-profiles-you-want-installed-when-creating-a-cluster"},"2. Select which profiles you want installed when creating a cluster"),(0,a.kt)("p",null,"Currenly WGE inspects the current namespace that it is deployed in (in the management cluster) for a ",(0,a.kt)("inlineCode",{parentName:"p"},"HelmRepository")," object named ",(0,a.kt)("inlineCode",{parentName:"p"},"weaveworks-charts"),". This Kubernetes object should be pointing to a Helm chart repository that includes the profiles that are available for installation."),(0,a.kt)("p",null,"When creating a cluster from the UI using a CAPI template, these profiles should be available for selection in the ",(0,a.kt)("inlineCode",{parentName:"p"},"Profiles")," section of the template. For example:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Profiles Selection",src:n(68023).Z})),(0,a.kt)("p",null,"As shown above, some profiles will be optional whereas some profiles will be required. This is determined when the template is authored and allows for operation teams to control which Helm packages should be installed on new clusters by default."))}p.isMDXComponent=!0},68023:function(e,t,n){"use strict";t.Z=n.p+"assets/images/profile-selection-035440f481a936a8315f82539c680edd.png"}}]);