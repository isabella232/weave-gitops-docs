<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RD8E3F9BEH"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-RD8E3F9BEH",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Weave GitOps" href="/opensearch.xml"><title data-react-helmet="true">Upgrading | Weave GitOps</title><meta data-react-helmet="true" property="og:url" content="https://docs.gitops.weave.works//docs/enterprise/upgrading"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.5.0"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.5.0"><meta data-react-helmet="true" property="og:title" content="Upgrading | Weave GitOps"><meta data-react-helmet="true" name="description" content="How to: Install Weave GitOps Enterprise"><meta data-react-helmet="true" property="og:description" content="How to: Install Weave GitOps Enterprise"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_150px.png"><link data-react-helmet="true" rel="canonical" href="https://docs.gitops.weave.works//docs/enterprise/upgrading"><link data-react-helmet="true" rel="alternate" href="https://docs.gitops.weave.works//docs/enterprise/upgrading" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.gitops.weave.works//docs/enterprise/upgrading" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.5eca8642.css">
<link rel="preload" href="/assets/js/runtime~main.cf8525d1.js" as="script">
<link rel="preload" href="/assets/js/main.193f1f59.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Weave GitOps</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Introduction</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/installation">Installation</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Getting Started</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/aws-marketplace">AWS Marketplace</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/intro">0.5.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/enterprise/upgrading">main</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/enterprise/upgrading">0.5.0</a></li><li><a class="dropdown__link" href="/docs/0.4.1/enterprise/upgrading">0.4.1</a></li><li><a class="dropdown__link" href="/docs/0.4.0/enterprise/upgrading">0.4.0</a></li><li><a class="dropdown__link" href="/docs/0.3.3/enterprise/upgrading">0.3.3</a></li><li><a class="dropdown__link" href="/docs/0.3.1/enterprise/upgrading">0.3.1</a></li><li><a class="dropdown__link" href="/docs/0.3.0/enterprise/upgrading">0.3.0</a></li><li><a class="dropdown__link" href="/docs/0.2.5/intro">0.2.5</a></li><li><a class="dropdown__link" href="/docs/0.2.4/intro">0.2.4</a></li><li><a class="dropdown__link" href="/docs/0.2.2/intro">0.2.2</a></li><li><a class="dropdown__link" href="/docs/0.2.1/intro">0.2.1</a></li><li><a class="dropdown__link" href="/docs/0.2.0/intro">0.2.0</a></li><li><a class="dropdown__link" href="/docs/0.0.5/intro">0.0.5</a></li></ul></div><a href="https://github.com/weaveworks/weave-gitops" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Weave GitOps</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/aws-marketplace">AWS Marketplace</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/enterprise/upgrading">main</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/enterprise/upgrading">0.5.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.4.1/enterprise/upgrading">0.4.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.4.0/enterprise/upgrading">0.4.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.3.3/enterprise/upgrading">0.3.3</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.3.1/enterprise/upgrading">0.3.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.3.0/enterprise/upgrading">0.3.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.5/intro">0.2.5</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.4/intro">0.2.4</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.2/intro">0.2.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.1/intro">0.2.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.0/intro">0.2.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.0.5/intro">0.0.5</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/weaveworks/weave-gitops" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops">gitops</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_add">gitops_add</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_add_app">gitops_add_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_add_cluster">gitops_add_cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_beta">gitops_beta</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_beta_add">gitops_beta_add</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_beta_add_app">gitops_beta_add_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_beta_init">gitops_beta_init</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_beta_install">gitops_beta_install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_delete">gitops_delete</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_delete_app">gitops_delete_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_delete_cluster">gitops_delete_cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_flux">gitops_flux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_flux_status">gitops_flux_status</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get">gitops_get</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get_app">gitops_get_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get_cluster">gitops_get_cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get_commits">gitops_get_commits</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get_credential">gitops_get_credential</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_get_template">gitops_get_template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_install">gitops_install</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_resume">gitops_resume</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_resume_app">gitops_resume_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_suspend">gitops_suspend</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_suspend_app">gitops_suspend_app</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_ui">gitops_ui</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_ui_run">gitops_ui_run</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_uninstall">gitops_uninstall</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_upgrade">gitops_upgrade</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cli-reference/gitops_version">gitops_version</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/gitops-dashboard">GitOps Dashboard</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/aws-marketplace">AWS Marketplace</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/examples/sock-shop">Deploying the Sock Shop Application</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/gitops-automation">GitOps Automation Configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster management</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/managing-existing-clusters">Managing existing clusters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/cluster-api-providers">Cluster API Providers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/templates">CAPI Templates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/provider-identities">CAPI Provider Identities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/deleting-a-cluster">Deleting a Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/profiles">Profiles</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Enterprise</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise/intro">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/enterprise/upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise/configuration">Configuration</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 0.5.0</span><div class="markdown"><header><h1 class="h1Heading_27L5">Upgrading</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-install-weave-gitops-enterprise"></a>How to: Install Weave GitOps Enterprise<a class="hash-link" href="#how-to-install-weave-gitops-enterprise" title="Direct link to heading">#</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>BEFORE YOU START</h5></div><div class="admonition-content"><p>Make sure the following software is installed before continuing with these instructions:</p><ul><li><code>gitops</code> &gt;= 0.5.0-rc2. Use <code>gitops version</code> to check the currently installed version. If needed, download a newer version of Weave GitOps from the <a href="https://github.com/weaveworks/weave-gitops/releases" target="_blank" rel="noopener noreferrer">releases page</a>.</li></ul><p>Also <code>GITHUB_TOKEN</code> must be set as an environment variable in the current shell. It should have permissions to create Pull Requests against the cluster config repo.</p></div></div><p>Installing requires we:</p><ol><li>Have a cluster with Weave GitOps installed</li><li>Install a CAPI provider</li><li>Apply the entitlements secret</li><li>Upgrade</li><li>Check that Weave GitOps Enterprise has been installed</li><li>Connect the management cluster up to itself</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-install-gitops-on-a-new-cluster"></a>1. Install <code>gitops</code> on a new cluster<a class="hash-link" href="#1-install-gitops-on-a-new-cluster" title="Direct link to heading">#</a></h3><p>We&#x27;ll use <code>kind</code> here as an example.</p><ul><li>The <code>extraMounts</code> are for the Docker CAPI provider (CAPD)</li><li><code>extraPortMappings</code> are for easily accessing NATS and the UI</li></ul><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">kind-config.yaml</div><div class="codeBlockContent_hGly yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Cluster</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kind.x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">k8s.io/v1alpha4</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">nodes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">role</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> control</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">plane</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">extraMounts</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">hostPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /var/run/docker.sock</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">containerPath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> /var/run/docker.sock</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">extraPortMappings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30080</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">hostPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30080</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">listenAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.0.0.0&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional, defaults to &quot;0.0.0.0&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tcp </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional, defaults to tcp</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">31490</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">hostPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">31490</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">listenAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0.0.0.0&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional, defaults to &quot;0.0.0.0&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tcp </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Optional, defaults to tcp</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Fire up cluster</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kind create cluster --config kind-config.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Create a new repo</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gh repo create my-management-cluster --private --confirm</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> my-management-cluster</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;# my-management-cluster&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> README.md</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> README.md</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> commit --all --message </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;init commit&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push -u origin main</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Install Weave Gitops</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gitops </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --app-config-url https://github.com/my-org/my-repo</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-install-a-capi-provider"></a>2. Install a CAPI provider<a class="hash-link" href="#2-install-a-capi-provider" title="Direct link to heading">#</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span><code>clusterctl</code> versions</h5></div><div class="admonition-content"><p>The example templates provided in this guide have been tested with <code>clusterctl</code> version <code>1.0.1</code>. However you might need to use an older or newer version depending on the capi-providers you plan on using.</p><p>Download a specific version of clusterctl from the <a href="https://github.com/kubernetes-sigs/cluster-api/releases" target="_blank" rel="noopener noreferrer">releases page</a>.</p></div></div><p>In order to be able to provision Kubernetes clusters, a CAPI provider needs to be installed.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">clusterctl init --infrastructure docker</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-apply-the-entitlements-secret"></a>3. Apply the entitlements secret<a class="hash-link" href="#3-apply-the-entitlements-secret" title="Direct link to heading">#</a></h3><p>Contact <a href="mailto:sales@weave.works" target="_blank" rel="noopener noreferrer">sales@weave.works</a> for a valid entitlements secret. Then apply it to the cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f entitlements.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In addition, you will add your git repository token (in this example, GitHub) as a secret. This is used to update the configurations and manifests in the management repository.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic git-provider-credentials --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">wego-system --from-literal</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GIT_PROVIDER_TOKEN=</span><span class="token string variable" style="color:rgb(191, 199, 213)">$GITHUB_TOKEN</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-upgrade"></a>4. Upgrade<a class="hash-link" href="#4-upgrade" title="Direct link to heading">#</a></h3><p>Run the upgrade command specifying the same <code>--app-config-repo</code> used in install and the desired version of Weave GitOps Enterprise.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gitops upgrade --app-config-url https://github.com/my-org/my-repo --profile-version </span><span class="token number" style="color:rgb(247, 140, 108)">0.0</span><span class="token plain">.16</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You may need to add the <code>--base</code> flag to the above command to indicate your local branch name, if it is not set to <code>main</code>.</p></div></div><p>A <strong>Pull Request</strong> will be created against your cluster repository. <strong>Review and merge</strong> this pull request to upgrade to Weave GitOps Enterprise.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-checking-that-wge-is-installed"></a>5. Checking that WGE is installed<a class="hash-link" href="#5-checking-that-wge-is-installed" title="Direct link to heading">#</a></h3><p>You should now be able to load the WGE UI:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl port-forward --namespace wego-system deployments.apps/weave-gitops-enterprise-nginx-ingress-controller </span><span class="token number" style="color:rgb(247, 140, 108)">8000</span><span class="token plain">:80</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The WGE UI should now be accessible at <a href="http://localhost:8000" target="_blank" rel="noopener noreferrer">http://localhost:8000</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-connect-the-management-cluster-up-to-itself"></a>6. Connect the management cluster up to itself<a class="hash-link" href="#6-connect-the-management-cluster-up-to-itself" title="Direct link to heading">#</a></h3><p><em>Connecting a cluster</em> installs the agent which is responsible for detecting new clusters and reporting their status to the UI. We need to install the agent on our newly created management cluster. Check out <a href="/docs/cluster-management/managing-existing-clusters#how-to-connect-a-cluster">How to: Connect a cluster</a>. The agent should be loaded onto our new management cluster, give it a name like <strong>Management</strong> and leave the Ingress URL blank.</p><p>Head over to <a href="/docs/cluster-management/getting-started">Getting started</a> to create your first CAPI Cluster.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/weaveworks/weave-gitops-docs/edit/main/versioned_docs/version-0.5.0/enterprise/upgrading.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/enterprise/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/enterprise/configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-install-weave-gitops-enterprise" class="table-of-contents__link">How to: Install Weave GitOps Enterprise</a><ul><li><a href="#1-install-gitops-on-a-new-cluster" class="table-of-contents__link">1. Install <code>gitops</code> on a new cluster</a></li><li><a href="#2-install-a-capi-provider" class="table-of-contents__link">2. Install a CAPI provider</a></li><li><a href="#3-apply-the-entitlements-secret" class="table-of-contents__link">3. Apply the entitlements secret</a></li><li><a href="#4-upgrade" class="table-of-contents__link">4. Upgrade</a></li><li><a href="#5-checking-that-wge-is-installed" class="table-of-contents__link">5. Checking that WGE is installed</a></li><li><a href="#6-connect-the-management-cluster-up-to-itself" class="table-of-contents__link">6. Connect the management cluster up to itself</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items"><li class="footer__item"><a href="mailto:support@weave.works" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Contact Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Weaveworks</div></div></div></footer></div>
<script src="/assets/js/runtime~main.cf8525d1.js"></script>
<script src="/assets/js/main.193f1f59.js"></script>
</body>
</html>